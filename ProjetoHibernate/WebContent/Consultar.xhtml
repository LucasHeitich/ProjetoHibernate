<ui:composition template="/templates/Layout.xhtml"
 xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	<ui:define name="conteudo">
	
	<div class="container" style="margin-top:30px;">
	<f:ajax event="load" onevent="document.getElementById('formulario:busca_texto').focus()"/>
		<h:form id="formulario" >
		
		<div class="barra-de-pesquisa" >
			<h:panelGrid class="tabela">
				<!-- Barra de Pesquisa -->
				<h:outputLabel for="busca_texto" title="Pesquise por Nome/Código"  value="Pesquisar:"/> 
				
				<p:inputText  id="busca_texto" styleClass="busca_texto" value="#{relatorioMB.filtro}">
					<f:ajax event="keyup" listener="#{relatorioMB.buscarFiltro}" render="tabela"/>
				</p:inputText>	
			</h:panelGrid>
		</div>
		<!-- Criação da Tabela -->
			<p:dataTable paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			currentPageReportTemplate="Exibindo de {startRecord} a {endRecord}"    
                 rowsPerPageTemplate="5,10,15" paginator="true" rows="10" id="tabela" value="#{not empty relatorioMB.filtro ? relatorioMB.alunoFiltrado : relatorioMB.todosAlunos}" var="item"
			rendered="#{not empty relatorioMB.todosAlunos}" emptyMessage="Sua pesquisa por ' #{relatorioMB.filtro} ' , não encontrou nenhum resultado. Verifique se as palavras estão escritas corretamente ou reescreva sua busca usando termos mais genéricos.">
		
			 <f:facet name="header">  
            	Relatório
        	</f:facet>  
		
			<p:column headerClass="check-column">
			<f:facet name="header">Código</f:facet>
				<h:outputText value="#{item.iAlunos}"/>
			</p:column>
			<p:column headerClass="check-column">
			<f:facet name="header">Nome</f:facet>
				<h:outputText value="#{item.nome}"/>
			</p:column>


			<p:column headerClass="check-column">
			<f:facet name="header">Data de Nascimento</f:facet>
				<h:outputText value="#{item.dataNascimento}"/>
			</p:column>

			<!-- Opção editar -->
			
			<p:column headerClass="check-column">
				<h:commandButton image="/imagens/updateIcon.jpg" title="Editar este usuário" 
					action="#{redirecionarPaginaBean.redirecionar}" value="Alterar" >
				<f:setPropertyActionListener target="#{redirecionarPaginaBean.local}" value="Alterar" />
				<f:ajax listener="#{relatorioMB.alterarCadastro(item)}" />
			</h:commandButton>
			
			</p:column>
			
			 
			
			<p:column headerClass="check-column">
				<h:commandLink  title="Deletar Usuário">
					<h:graphicImage value="/imagens/deleteIcon.png"/>
					<f:ajax  listener="#{relatorioMB.excluir(item)}" render="@form" />
				</h:commandLink> 
				
			</p:column>
			
			</p:dataTable>

			

		</h:form>
	</div>
	</ui:define>
</ui:composition>
